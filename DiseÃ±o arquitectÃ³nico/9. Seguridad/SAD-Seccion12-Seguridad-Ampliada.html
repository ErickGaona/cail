<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAD CAIL - Secci√≥n 12: Seguridad (Versi√≥n Ampliada)</title>
    <style>
        body {
            font-family: 'Calibri', 'Arial', sans-serif;
            font-size: 11pt;
            line-height: 1.5;
            margin: 2.5cm;
            color: #333;
        }
        h1 {
            font-size: 18pt;
            color: #1a365d;
            border-bottom: 3px solid #2c5282;
            padding-bottom: 10px;
            page-break-before: always;
        }
        h1:first-of-type {
            page-break-before: avoid;
        }
        h2 {
            font-size: 14pt;
            color: #2c5282;
            margin-top: 24pt;
            border-bottom: 1px solid #4a5568;
            padding-bottom: 5px;
        }
        h3 {
            font-size: 12pt;
            color: #4a5568;
            margin-top: 18pt;
        }
        h4 {
            font-size: 11pt;
            color: #718096;
            margin-top: 14pt;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 12pt 0;
            font-size: 10pt;
        }
        th {
            background-color: #2c5282;
            color: white;
            padding: 8px 10px;
            text-align: left;
            font-weight: bold;
        }
        td {
            border: 1px solid #cbd5e0;
            padding: 6px 10px;
            vertical-align: top;
        }
        tr:nth-child(even) {
            background-color: #f7fafc;
        }
        tr:hover {
            background-color: #edf2f7;
        }
        code {
            font-family: 'Consolas', 'Courier New', monospace;
            background-color: #edf2f7;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 9pt;
        }
        pre {
            background-color: #1a202c;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 9pt;
            line-height: 1.4;
        }
        .note {
            background-color: #ebf8ff;
            border-left: 4px solid #3182ce;
            padding: 12px 15px;
            margin: 15px 0;
            font-style: italic;
        }
        .warning {
            background-color: #fffbeb;
            border-left: 4px solid #d69e2e;
            padding: 12px 15px;
            margin: 15px 0;
        }
        .critical {
            background-color: #fff5f5;
            border-left: 4px solid #c53030;
            padding: 12px 15px;
            margin: 15px 0;
        }
        .alto {
            color: #c53030;
            font-weight: bold;
        }
        .medio {
            color: #d69e2e;
            font-weight: bold;
        }
        .bajo {
            color: #38a169;
            font-weight: bold;
        }
        .critico {
            color: #822727;
            font-weight: bold;
            background-color: #fed7d7;
            padding: 2px 6px;
        }
        .cumplido {
            color: #276749;
            font-weight: bold;
        }
        .header-info {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #f7fafc;
            border: 1px solid #e2e8f0;
        }
        .header-info img {
            max-width: 200px;
        }
        .toc {
            background-color: #f7fafc;
            padding: 20px;
            border: 1px solid #e2e8f0;
            margin: 20px 0;
        }
        .toc h3 {
            margin-top: 0;
        }
        .toc ul {
            margin: 0;
            padding-left: 20px;
        }
        .toc li {
            margin: 5px 0;
        }
        .diagram {
            background-color: #f0f4f8;
            border: 1px solid #cbd5e0;
            padding: 15px;
            font-family: 'Consolas', monospace;
            font-size: 8pt;
            white-space: pre;
            overflow-x: auto;
            line-height: 1.2;
        }
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
            text-align: center;
            font-size: 9pt;
            color: #718096;
        }
        @media print {
            body { margin: 1.5cm; }
            h1 { page-break-before: always; }
            table { page-break-inside: avoid; }
            pre { page-break-inside: avoid; }
        }
    </style>
</head>
<body>

<!-- PORTADA -->
<div class="header-info">
    <h1 style="border: none; page-break-before: avoid; text-align: center;">
        DOCUMENTO DE ARQUITECTURA DE SOFTWARE<br>
        <span style="font-size: 14pt; color: #4a5568;">Bolsa de Empleo CAIL</span>
    </h1>
    <h2 style="border: none; text-align: center; color: #2c5282;">
        Secci√≥n 12: SEGURIDAD<br>
        <span style="font-size: 11pt; font-weight: normal;">(Versi√≥n Ampliada)</span>
    </h2>
    <p><strong>Versi√≥n:</strong> 1.1 | <strong>Fecha:</strong> Diciembre 2025</p>
    <p><strong>Estado:</strong> Para integraci√≥n en SAD principal</p>
</div>

<!-- NOTA INTRODUCTORIA -->
<div class="note">
    <strong>Nota:</strong> Este documento contiene las mejoras solicitadas para la secci√≥n de seguridad del SAD-CAIL, 
    incluyendo las nuevas subsecciones 12.6, 12.7, 12.8, 12.9 y las mejoras a 12.2 y 12.3.
</div>

<!-- TABLA DE CONTENIDOS -->
<div class="toc">
    <h3>Contenido de esta Secci√≥n</h3>
    <ul>
        <li>12.2. Seguridad de Aplicaciones Web (OWASP) ‚Äî MEJORADO</li>
        <li>12.3. Seguridad de Aplicaciones M√≥viles (OWASP) ‚Äî MEJORADO</li>
        <li>12.6. An√°lisis de Amenazas y Matriz de Riesgos ‚Äî NUEVA</li>
        <li>12.7. M√©tricas y Monitoreo de Seguridad ‚Äî NUEVA</li>
        <li>12.8. Referencias Cruzadas de Seguridad ‚Äî NUEVA</li>
        <li>12.9. Plan de Cumplimiento y Auditor√≠a ‚Äî NUEVA</li>
        <li>ANEXO A: Glosario de T√©rminos T√©cnicos ‚Äî NUEVA</li>
    </ul>
</div>

<!-- ============================================================ -->
<!-- SECCI√ìN 12.2 MEJORADA -->
<!-- ============================================================ -->
<h1>12.2. Seguridad de Aplicaciones Web (OWASP)</h1>

<h3>Enfoque</h3>
<p>Esta secci√≥n detalla los controles de seguridad <strong>espec√≠ficos para la versi√≥n web</strong> de CAIL, 
accesible mediante navegador. Se diferencia de los controles m√≥viles (12.3) para evitar redundancia.</p>

<h3>Controles Espec√≠ficos Web</h3>
<table>
    <tr>
        <th>Control</th>
        <th>Implementaci√≥n</th>
        <th>Justificaci√≥n OWASP</th>
    </tr>
    <tr>
        <td><strong>CSP (Content Security Policy)</strong></td>
        <td>Headers HTTP estrictos: <code>default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'</code></td>
        <td>Previene XSS (A03:2021)</td>
    </tr>
    <tr>
        <td><strong>CORS</strong></td>
        <td>Allowlist de dominios autorizados: <code>*.cail.ec</code>, <code>*.firebaseapp.com</code></td>
        <td>Previene CSRF y data leakage</td>
    </tr>
    <tr>
        <td><strong>Cookie Security</strong></td>
        <td>Flags: <code>HttpOnly</code>, <code>Secure</code>, <code>SameSite=Strict</code></td>
        <td>Protege sesiones (A07:2021)</td>
    </tr>
    <tr>
        <td><strong>Rate Limiting</strong></td>
        <td>Throttling en WSO2 Gateway: 100 req/min por IP, 1000 req/min por usuario</td>
        <td>Previene DoS y brute-force</td>
    </tr>
    <tr>
        <td><strong>Subresource Integrity (SRI)</strong></td>
        <td>Hash SHA-384 para scripts externos de CDN</td>
        <td>Previene supply-chain attacks</td>
    </tr>
    <tr>
        <td><strong>X-Frame-Options</strong></td>
        <td><code>DENY</code> para prevenir clickjacking</td>
        <td>Protecci√≥n de UI</td>
    </tr>
    <tr>
        <td><strong>X-Content-Type-Options</strong></td>
        <td><code>nosniff</code> para prevenir MIME sniffing</td>
        <td>Previene ejecuci√≥n maliciosa</td>
    </tr>
</table>

<h3>Controles en Capa de Presentaci√≥n (React Web)</h3>
<pre>
// Ejemplo: Sanitizaci√≥n de inputs en formularios React
import DOMPurify from 'dompurify';

const sanitizeInput = (userInput) => {
  return DOMPurify.sanitize(userInput, {
    ALLOWED_TAGS: [], // Solo texto plano
    ALLOWED_ATTR: []
  });
};

// Uso en formulario de b√∫squeda de ofertas
const handleSearch = (searchTerm) => {
  const cleanTerm = sanitizeInput(searchTerm);
  // Enviar a API Gateway
};
</pre>

<!-- ============================================================ -->
<!-- SECCI√ìN 12.3 MEJORADA -->
<!-- ============================================================ -->
<h1>12.3. Seguridad de Aplicaciones M√≥viles (OWASP)</h1>

<h3>Enfoque</h3>
<p>Esta secci√≥n detalla los controles de seguridad <strong>exclusivos para las apps iOS y Android</strong> de CAIL, 
desarrolladas en React Native. Los riesgos m√≥viles difieren significativamente de los web.</p>

<h3>Controles Espec√≠ficos por Plataforma</h3>
<table>
    <tr>
        <th>Control</th>
        <th>Android</th>
        <th>iOS</th>
    </tr>
    <tr>
        <td><strong>Almacenamiento Seguro de Tokens</strong></td>
        <td><code>EncryptedSharedPreferences</code> + Android Keystore</td>
        <td>Keychain Services con <code>kSecAttrAccessibleWhenUnlockedThisDeviceOnly</code></td>
    </tr>
    <tr>
        <td><strong>Detecci√≥n de Root/Jailbreak</strong></td>
        <td>RootBeer library + SafetyNet Attestation API</td>
        <td>IOSSecuritySuite + DeviceCheck API</td>
    </tr>
    <tr>
        <td><strong>Certificate Pinning</strong></td>
        <td>OkHttp <code>CertificatePinner</code> con SHA-256</td>
        <td><code>URLSession</code> con <code>NSURLSessionPinningDelegate</code></td>
    </tr>
    <tr>
        <td><strong>Ofuscaci√≥n de C√≥digo</strong></td>
        <td>ProGuard/R8 en release builds</td>
        <td>Habilitado por defecto + Bitcode</td>
    </tr>
    <tr>
        <td><strong>Biometr√≠a</strong></td>
        <td><code>BiometricPrompt</code> API (Clase 3)</td>
        <td><code>LocalAuthentication</code> (Face ID/Touch ID)</td>
    </tr>
    <tr>
        <td><strong>Prevenci√≥n de Screenshot</strong></td>
        <td><code>FLAG_SECURE</code> en Activities con datos sensibles</td>
        <td>No disponible nativamente (advertencia al usuario)</td>
    </tr>
    <tr>
        <td><strong>Anti-Tampering</strong></td>
        <td>Verificaci√≥n de firma APK en runtime</td>
        <td>App Transport Security (ATS)</td>
    </tr>
    <tr>
        <td><strong>Secure Clipboard</strong></td>
        <td>Timeout de 60s para datos copiados</td>
        <td><code>UIPasteboard</code> con <code>expirationDate</code></td>
    </tr>
</table>

<h3>Ejemplo: Almacenamiento Seguro en React Native</h3>
<pre>
// Uso de react-native-keychain para almacenamiento seguro
import * as Keychain from 'react-native-keychain';

// Guardar token de forma segura
const storeToken = async (token) => {
  await Keychain.setGenericPassword('authToken', token, {
    accessible: Keychain.ACCESSIBLE.WHEN_UNLOCKED_THIS_DEVICE_ONLY,
    securityLevel: Keychain.SECURITY_LEVEL.SECURE_HARDWARE, // Android Keystore
  });
};

// Recuperar token
const getToken = async () => {
  const credentials = await Keychain.getGenericPassword();
  return credentials ? credentials.password : null;
};
</pre>

<h3>Detecci√≥n de Dispositivo Comprometido</h3>
<pre>
// Pseudoc√≥digo para detecci√≥n de root/jailbreak
import { isRooted, isJailbroken } from 'react-native-device-info';

const checkDeviceSecurity = async () => {
  const isCompromised = Platform.OS === 'android' 
    ? await isRooted() 
    : await isJailbroken();
  
  if (isCompromised) {
    // Bloquear acceso a funciones sensibles
    Alert.alert(
      'Dispositivo No Seguro',
      'Esta aplicaci√≥n no puede ejecutarse en dispositivos modificados.'
    );
    return false;
  }
  return true;
};
</pre>

<!-- ============================================================ -->
<!-- SECCI√ìN 12.6 NUEVA -->
<!-- ============================================================ -->
<h1>12.6. An√°lisis de Amenazas y Matriz de Riesgos</h1>

<p>Esta secci√≥n documenta el an√°lisis sistem√°tico de amenazas basado en los est√°ndares 
<strong>OWASP Top 10 (2021)</strong> y <strong>OWASP Mobile Top 10 (2024)</strong>, 
clasificando cada riesgo seg√∫n su probabilidad, impacto y las mitigaciones implementadas.</p>

<h2>12.6.1. Matriz de Riesgos OWASP Top 10 Web (2021)</h2>
<table>
    <tr>
        <th>ID</th>
        <th>Amenaza OWASP</th>
        <th>Probabilidad</th>
        <th>Impacto</th>
        <th>Riesgo</th>
        <th>Mitigaci√≥n Implementada en CAIL</th>
    </tr>
    <tr>
        <td>A01:2021</td>
        <td><strong>Broken Access Control</strong></td>
        <td>Media</td>
        <td>Alto</td>
        <td class="alto">ALTO</td>
        <td>RBAC en Firebase Security Rules + validaci√≥n server-side en Cloud Functions. Regla: <code>allow read: if request.auth.uid == resource.data.userId</code></td>
    </tr>
    <tr>
        <td>A02:2021</td>
        <td><strong>Cryptographic Failures</strong></td>
        <td>Baja</td>
        <td>Alto</td>
        <td class="medio">Medio</td>
        <td>TLS 1.3 obligatorio en todas las conexiones + Argon2id para hashing de contrase√±as con salt √∫nico</td>
    </tr>
    <tr>
        <td>A03:2021</td>
        <td><strong>Injection</strong></td>
        <td>Media</td>
        <td>Alto</td>
        <td class="alto">ALTO</td>
        <td>Firestore SDK no usa SQL. Validaci√≥n de inputs con Zod schema. Sanitizaci√≥n HTML con DOMPurify</td>
    </tr>
    <tr>
        <td>A04:2021</td>
        <td><strong>Insecure Design</strong></td>
        <td>Baja</td>
        <td>Medio</td>
        <td class="bajo">Bajo</td>
        <td>Threat modeling en fase de dise√±o. Revisi√≥n de arquitectura por Security Champion</td>
    </tr>
    <tr>
        <td>A05:2021</td>
        <td><strong>Security Misconfiguration</strong></td>
        <td>Media</td>
        <td>Medio</td>
        <td class="medio">Medio</td>
        <td>IaC auditado + Firebase Security Rules testing con emulador. Firestore rules coverage > 90%</td>
    </tr>
    <tr>
        <td>A06:2021</td>
        <td><strong>Vulnerable Components</strong></td>
        <td>Media</td>
        <td>Alto</td>
        <td class="alto">ALTO</td>
        <td>Dependabot habilitado en GitHub + <code>npm audit</code> obligatorio en CI/CD pipeline. Bloqueo de builds con vulnerabilidades cr√≠ticas</td>
    </tr>
    <tr>
        <td>A07:2021</td>
        <td><strong>Auth Failures</strong></td>
        <td>Baja</td>
        <td>Alto</td>
        <td class="medio">Medio</td>
        <td>Firebase Auth con MFA opcional + rate limiting (5 intentos/15min). Tokens JWT con expiraci√≥n de 1 hora</td>
    </tr>
    <tr>
        <td>A08:2021</td>
        <td><strong>Data Integrity Failures</strong></td>
        <td>Baja</td>
        <td>Medio</td>
        <td class="bajo">Bajo</td>
        <td>Verificaci√≥n de firma en actualizaciones OTA (Expo Updates). Integridad de bundle verificada</td>
    </tr>
    <tr>
        <td>A09:2021</td>
        <td><strong>Logging Failures</strong></td>
        <td>Media</td>
        <td>Medio</td>
        <td class="medio">Medio</td>
        <td>Cloud Logging + alertas autom√°ticas en Security Command Center. Retenci√≥n de logs: 90 d√≠as</td>
    </tr>
    <tr>
        <td>A10:2021</td>
        <td><strong>SSRF</strong></td>
        <td>Baja</td>
        <td>Alto</td>
        <td class="medio">Medio</td>
        <td>Validaci√≥n de URLs + allowlist de dominios externos (Registro Civil, Senescyt). No se permiten URLs din√°micas</td>
    </tr>
</table>

<h2>12.6.2. Matriz de Riesgos OWASP Mobile Top 10 (2024)</h2>
<table>
    <tr>
        <th>ID</th>
        <th>Amenaza Mobile</th>
        <th>Probabilidad</th>
        <th>Impacto</th>
        <th>Riesgo</th>
        <th>Mitigaci√≥n Espec√≠fica en CAIL</th>
    </tr>
    <tr>
        <td>M1</td>
        <td><strong>Improper Platform Usage</strong></td>
        <td>Media</td>
        <td>Alto</td>
        <td class="alto">ALTO</td>
        <td>Uso correcto de APIs nativas: Keychain (iOS), Keystore (Android). No almacenamiento en AsyncStorage para datos sensibles</td>
    </tr>
    <tr>
        <td>M2</td>
        <td><strong>Insecure Data Storage</strong></td>
        <td>Alta</td>
        <td>Alto</td>
        <td class="critico">CR√çTICO</td>
        <td><code>EncryptedSharedPreferences</code> (Android) / Keychain (iOS). Base de datos local cifrada con SQLCipher si se requiere offline</td>
    </tr>
    <tr>
        <td>M3</td>
        <td><strong>Insecure Communication</strong></td>
        <td>Baja</td>
        <td>Alto</td>
        <td class="medio">Medio</td>
        <td>Certificate Pinning implementado. TLS 1.3. No se permite HTTP en ning√∫n caso (ATS enforced)</td>
    </tr>
    <tr>
        <td>M4</td>
        <td><strong>Insecure Authentication</strong></td>
        <td>Media</td>
        <td>Alto</td>
        <td class="alto">ALTO</td>
        <td>Biometr√≠a + tokens JWT con refresh. Session timeout: 30 min inactividad. Re-autenticaci√≥n para operaciones cr√≠ticas</td>
    </tr>
    <tr>
        <td>M5</td>
        <td><strong>Insufficient Cryptography</strong></td>
        <td>Baja</td>
        <td>Alto</td>
        <td class="medio">Medio</td>
        <td>AES-256-GCM para datos locales. No se implementa criptograf√≠a custom, solo APIs nativas</td>
    </tr>
    <tr>
        <td>M6</td>
        <td><strong>Insecure Authorization</strong></td>
        <td>Media</td>
        <td>Alto</td>
        <td class="alto">ALTO</td>
        <td>Validaci√≥n de permisos server-side en Cloud Functions. El cliente nunca es fuente de verdad para autorizaciones</td>
    </tr>
    <tr>
        <td>M7</td>
        <td><strong>Client Code Quality</strong></td>
        <td>Media</td>
        <td>Medio</td>
        <td class="medio">Medio</td>
        <td>ESLint con plugins de seguridad (<code>eslint-plugin-security</code>). Code review obligatorio. SonarQube en CI</td>
    </tr>
    <tr>
        <td>M8</td>
        <td><strong>Code Tampering</strong></td>
        <td>Baja</td>
        <td>Alto</td>
        <td class="medio">Medio</td>
        <td>ProGuard/R8 ofuscaci√≥n. Detecci√≥n de root/jailbreak. Verificaci√≥n de integridad del APK/IPA</td>
    </tr>
    <tr>
        <td>M9</td>
        <td><strong>Reverse Engineering</strong></td>
        <td>Media</td>
        <td>Medio</td>
        <td class="medio">Medio</td>
        <td>API keys nunca en c√≥digo cliente. Secrets en variables de entorno del backend. Ofuscaci√≥n de c√≥digo</td>
    </tr>
    <tr>
        <td>M10</td>
        <td><strong>Extraneous Functionality</strong></td>
        <td>Baja</td>
        <td>Bajo</td>
        <td class="bajo">Bajo</td>
        <td>Eliminaci√≥n de <code>console.log</code> en release. No hay endpoints de debug en producci√≥n. Build variants separados</td>
    </tr>
</table>

<h2>12.6.3. Ejemplo de Mitigaci√≥n: Validaci√≥n de Inputs con Zod</h2>
<pre>
// Cloud Function - Validaci√≥n robusta para prevenir injection
import { z } from 'zod';
import * as functions from 'firebase-functions';
import { sanitizeHtml } from 'sanitize-html';

// Schema de validaci√≥n para postulaci√≥n a oferta
const JobApplicationSchema = z.object({
  jobId: z.string()
    .uuid({ message: 'ID de oferta inv√°lido' }),
  
  userId: z.string()
    .min(20, 'UID demasiado corto')
    .max(128, 'UID demasiado largo')
    .regex(/^[a-zA-Z0-9]+$/, 'UID contiene caracteres inv√°lidos'),
  
  coverLetter: z.string()
    .min(50, 'La carta debe tener al menos 50 caracteres')
    .max(2000, 'La carta no puede exceder 2000 caracteres')
    .transform(val => sanitizeHtml(val, {
      allowedTags: [],      // Solo texto plano
      allowedAttributes: {} // Sin atributos HTML
    })),
  
  expectedSalary: z.number()
    .positive('El salario debe ser positivo')
    .max(100000, 'Salario fuera de rango')
    .optional(),
});

// Cloud Function con validaci√≥n completa
export const applyToJob = functions.https.onCall(async (data, context) => {
  // 1. Verificar autenticaci√≥n
  if (!context.auth) {
    throw new functions.https.HttpsError(
      'unauthenticated', 
      'Debe iniciar sesi√≥n para postularse'
    );
  }
  
  // 2. Validar y sanitizar inputs
  const parseResult = JobApplicationSchema.safeParse(data);
  if (!parseResult.success) {
    throw new functions.https.HttpsError(
      'invalid-argument',
      parseResult.error.errors[0].message
    );
  }
  const validatedData = parseResult.data;
  
  // 3. Verificar autorizaci√≥n (RBAC)
  const userDoc = await admin.firestore()
    .collection('users')
    .doc(context.auth.uid)
    .get();
  
  if (userDoc.data()?.role !== 'candidate') {
    throw new functions.https.HttpsError(
      'permission-denied', 
      'Solo los candidatos pueden postularse'
    );
  }
  
  // 4. Verificar que el usuario autenticado coincide con userId
  if (validatedData.userId !== context.auth.uid) {
    throw new functions.https.HttpsError(
      'permission-denied',
      'No puede postularse en nombre de otro usuario'
    );
  }
  
  // 5. Procesar solicitud segura
  return await createApplication(validatedData);
});
</pre>

<h2>12.6.4. Diagrama de Secuencia: Flujo de Autenticaci√≥n Segura</h2>
<div class="diagram">
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  App M√≥vil   ‚îÇ     ‚îÇ    WSO2      ‚îÇ     ‚îÇ   Firebase   ‚îÇ     ‚îÇ    Cloud     ‚îÇ     ‚îÇ  Firestore   ‚îÇ
‚îÇ   (React     ‚îÇ     ‚îÇ   Gateway    ‚îÇ     ‚îÇ     Auth     ‚îÇ     ‚îÇ  Functions   ‚îÇ     ‚îÇ              ‚îÇ
‚îÇ   Native)    ‚îÇ     ‚îÇ              ‚îÇ     ‚îÇ              ‚îÇ     ‚îÇ              ‚îÇ     ‚îÇ              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ 1. Login Request   ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ (email, password)  ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ 2. Validate        ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ credentials        ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ (Argon2 hash)      ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ 3. Return Tokens   ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ (ID Token + Refresh Token)             ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ 4. Store tokens securely               ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ (Keychain/Keystore)‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ 5. API Request     ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ + Bearer Token     ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ 6. Rate Limit      ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ Check (100 req/min)‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ 7. Validate JWT    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ 8. Token Valid     ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ + User Claims      ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ 9. Forward Request ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ (if authorized)    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ 10. Apply Security ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ Rules & Query      ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ 11. Return Data    ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ (filtered by rules)‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ 12. Response (TLS 1.3 encrypted)       ‚îÇ                    ‚îÇ                    ‚îÇ
       ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ                    ‚îÇ
</div>

<div class="note">
    <strong>Notas del Diagrama:</strong>
    <ul>
        <li><strong>Paso 4:</strong> Los tokens nunca se almacenan en AsyncStorage o localStorage, solo en almacenamiento seguro del sistema operativo.</li>
        <li><strong>Paso 6:</strong> WSO2 implementa throttling para prevenir ataques de fuerza bruta.</li>
        <li><strong>Paso 10:</strong> Las Security Rules de Firestore act√∫an como √∫ltima l√≠nea de defensa, verificando que el usuario solo acceda a sus propios datos.</li>
    </ul>
</div>

<!-- ============================================================ -->
<!-- SECCI√ìN 12.7 NUEVA -->
<!-- ============================================================ -->
<h1>12.7. M√©tricas y Monitoreo de Seguridad</h1>

<h2>12.7.1. KPIs de Seguridad</h2>
<table>
    <tr>
        <th>M√©trica</th>
        <th>Objetivo (SLO)</th>
        <th>Frecuencia</th>
        <th>Herramienta</th>
        <th>Responsable</th>
    </tr>
    <tr>
        <td>Tasa de detecci√≥n de vulnerabilidades SAST</td>
        <td>‚â• 95%</td>
        <td>Por commit</td>
        <td>SonarQube</td>
        <td>DevSecOps</td>
    </tr>
    <tr>
        <td>Cobertura de Security Rules testing</td>
        <td>‚â• 90%</td>
        <td>Por release</td>
        <td>Firebase Emulator</td>
        <td>Backend Dev</td>
    </tr>
    <tr>
        <td>Tiempo medio de parcheo (MTTR) - Cr√≠tico</td>
        <td>&lt; 24 horas</td>
        <td>Por incidente</td>
        <td>Jira + PagerDuty</td>
        <td>CSIRT</td>
    </tr>
    <tr>
        <td>Tiempo medio de parcheo (MTTR) - Alto</td>
        <td>&lt; 72 horas</td>
        <td>Por incidente</td>
        <td>Jira</td>
        <td>DevSecOps</td>
    </tr>
    <tr>
        <td>Tasa de falsos positivos WAF</td>
        <td>&lt; 5%</td>
        <td>Semanal</td>
        <td>WSO2 Analytics</td>
        <td>Infra</td>
    </tr>
    <tr>
        <td>Intentos de login fallidos consecutivos</td>
        <td>Alerta si > 5/15min</td>
        <td>Tiempo real</td>
        <td>Firebase Auth + Cloud Monitoring</td>
        <td>Security</td>
    </tr>
    <tr>
        <td>Dependencias con vulnerabilidades conocidas</td>
        <td>0 cr√≠ticas, &lt; 5 altas</td>
        <td>Diario</td>
        <td>Dependabot + npm audit</td>
        <td>DevSecOps</td>
    </tr>
    <tr>
        <td>Auditor√≠as de seguridad externas</td>
        <td>1 por semestre</td>
        <td>Semestral</td>
        <td>Proveedor certificado</td>
        <td>Gerencia</td>
    </tr>
    <tr>
        <td>Cumplimiento OWASP Top 10</td>
        <td>100% mitigaciones</td>
        <td>Trimestral</td>
        <td>Checklist interno</td>
        <td>Security Champion</td>
    </tr>
    <tr>
        <td>Cobertura de tests de seguridad</td>
        <td>‚â• 80%</td>
        <td>Por sprint</td>
        <td>Jest + Detox</td>
        <td>QA</td>
    </tr>
</table>

<h2>12.7.2. Herramientas de Monitoreo en Tiempo Real</h2>
<table>
    <tr>
        <th>Herramienta</th>
        <th>Prop√≥sito</th>
        <th>Integraci√≥n con CAIL</th>
    </tr>
    <tr>
        <td><strong>Google Cloud Security Command Center</strong></td>
        <td>Monitoreo centralizado de vulnerabilidades, amenazas y configuraciones incorrectas en GCP</td>
        <td>Habilitado para proyecto Firebase</td>
    </tr>
    <tr>
        <td><strong>Firebase Crashlytics</strong></td>
        <td>Detecci√≥n de crashes, incluyendo los relacionados con seguridad (memory corruption, stack overflow)</td>
        <td>SDK integrado en React Native</td>
    </tr>
    <tr>
        <td><strong>Cloud Audit Logs</strong></td>
        <td>Registro inmutable de todas las operaciones administrativas en GCP/Firebase</td>
        <td>Habilitado por defecto, retenci√≥n 400 d√≠as</td>
    </tr>
    <tr>
        <td><strong>Sentry</strong></td>
        <td>Monitoreo de errores en tiempo real con stack traces completos</td>
        <td>SDK integrado en frontend y Cloud Functions</td>
    </tr>
    <tr>
        <td><strong>WSO2 Analytics</strong></td>
        <td>M√©tricas de tr√°fico API, detecci√≥n de patrones an√≥malos, rate limiting</td>
        <td>Dashboard configurado</td>
    </tr>
</table>

<h2>12.7.3. Alertas Automatizadas</h2>
<table>
    <tr>
        <th>Evento</th>
        <th>Severidad</th>
        <th>Canal de Notificaci√≥n</th>
        <th>Tiempo de Respuesta</th>
    </tr>
    <tr>
        <td>M√∫ltiples intentos de login fallidos (>5/15min)</td>
        <td class="medio">Media</td>
        <td>Slack #security-alerts</td>
        <td>&lt; 1 hora</td>
    </tr>
    <tr>
        <td>Acceso desde pa√≠s no autorizado</td>
        <td class="alto">Alta</td>
        <td>Email + Slack + PagerDuty</td>
        <td>&lt; 30 min</td>
    </tr>
    <tr>
        <td>Vulnerabilidad cr√≠tica detectada en dependencia</td>
        <td class="critico">Cr√≠tica</td>
        <td>Email + Slack + PagerDuty</td>
        <td>Inmediato</td>
    </tr>
    <tr>
        <td>Cambio en Security Rules de Firestore</td>
        <td class="alto">Alta</td>
        <td>Slack #security-alerts</td>
        <td>&lt; 1 hora</td>
    </tr>
    <tr>
        <td>Pico anormal de tr√°fico (>300% promedio)</td>
        <td class="medio">Media</td>
        <td>Slack #infra-alerts</td>
        <td>&lt; 1 hora</td>
    </tr>
    <tr>
        <td>Error rate > 5% en Cloud Functions</td>
        <td class="alto">Alta</td>
        <td>PagerDuty</td>
        <td>&lt; 30 min</td>
    </tr>
</table>

<!-- ============================================================ -->
<!-- SECCI√ìN 12.8 NUEVA -->
<!-- ============================================================ -->
<h1>12.8. Referencias Cruzadas de Seguridad</h1>

<p>Esta secci√≥n establece las conexiones expl√≠citas entre los controles de seguridad y otras vistas arquitect√≥nicas del documento, asegurando una visi√≥n integral.</p>

<table>
    <tr>
        <th>Secci√≥n Relacionada</th>
        <th>Relaci√≥n con Seguridad</th>
    </tr>
    <tr>
        <td><strong>9. Vista de Despliegue</strong></td>
        <td>La redundancia geogr√°fica de Firebase (multi-regi√≥n <code>us-central1</code> + <code>europe-west1</code>) soporta la <strong>disponibilidad</strong> durante ataques DDoS. El diagrama 9.2 muestra la topolog√≠a de red donde el WAF perimetral protege el acceso al API Gateway WSO2.</td>
    </tr>
    <tr>
        <td><strong>11. Vista de Calidad (Disponibilidad)</strong></td>
        <td>El SLO del <strong>99.9% de uptime</strong> se mantiene mediante los controles del IRP (12.4). En caso de incidente S1, el failover autom√°tico a regi√≥n secundaria garantiza continuidad del servicio.</td>
    </tr>
    <tr>
        <td><strong>11. Vista de Calidad (Escalabilidad)</strong></td>
        <td>La arquitectura serverless permite <strong>escalado autom√°tico</strong> durante ataques volum√©tricos, absorbiendo picos sin degradaci√≥n. Cloud Functions escala a miles de instancias en segundos.</td>
    </tr>
    <tr>
        <td><strong>10. Vista de Datos</strong></td>
        <td>Las pol√≠ticas de retenci√≥n de datos (12.5) se implementan mediante <strong>Cloud Scheduler + Cloud Functions</strong> que ejecutan purga autom√°tica de cuentas inactivas (24 meses) y logs (90 d√≠as).</td>
    </tr>
    <tr>
        <td><strong>8. Vista de Implementaci√≥n</strong></td>
        <td>El pipeline CI/CD (8.6) incluye <strong>gates de seguridad obligatorios</strong>: SAST (SonarQube), dependency scanning (npm audit), y Security Rules testing. Un build con vulnerabilidades cr√≠ticas es bloqueado autom√°ticamente.</td>
    </tr>
    <tr>
        <td><strong>6. Vista L√≥gica</strong></td>
        <td>Las clases <code>AuthService</code> y <code>TokenService</code> del diagrama de clases implementan los patrones de autenticaci√≥n descritos en 12.3 y 12.6.4.</td>
    </tr>
    <tr>
        <td><strong>7. Vista de Procesos</strong></td>
        <td>Los diagramas de secuencia CU01 y CU02 muestran la integraci√≥n con Registro Civil y Senescyt, cuya comunicaci√≥n se realiza sobre <strong>TLS 1.3</strong> con validaci√≥n de certificados.</td>
    </tr>
</table>

<!-- ============================================================ -->
<!-- SECCI√ìN 12.9 NUEVA -->
<!-- ============================================================ -->
<h1>12.9. Plan de Cumplimiento y Auditor√≠a</h1>

<h2>12.9.1. Roadmap de Certificaciones</h2>
<table>
    <tr>
        <th>Certificaci√≥n</th>
        <th>Estado</th>
        <th>Fecha Objetivo</th>
        <th>Responsable</th>
        <th>Notas</th>
    </tr>
    <tr>
        <td><strong>LOPDP (Ecuador)</strong></td>
        <td class="cumplido">‚úÖ Cumplido</td>
        <td>Actual</td>
        <td>Legal + Arquitectura</td>
        <td>Implementado en Pol√≠tica de Privacidad y mecanismo de Consentimiento Informado</td>
    </tr>
    <tr>
        <td><strong>ISO 27001:2022</strong></td>
        <td>üìã Planificado</td>
        <td>Q4 2026</td>
        <td>Oficial de Seguridad</td>
        <td>Requiere auditor√≠a externa y documentaci√≥n de SGSI</td>
    </tr>
    <tr>
        <td><strong>SOC 2 Type II</strong></td>
        <td>üîç Evaluaci√≥n</td>
        <td>Q2 2027</td>
        <td>Auditor Externo</td>
        <td>Dependiente de madurez operacional</td>
    </tr>
</table>

<h2>12.9.2. Plan de Auditor√≠a</h2>
<table>
    <tr>
        <th>Tipo de Auditor√≠a</th>
        <th>Frecuencia</th>
        <th>Alcance</th>
        <th>Ejecutor</th>
    </tr>
    <tr>
        <td><strong>Revisi√≥n de Security Rules</strong></td>
        <td>Mensual</td>
        <td>Firestore rules, Storage rules</td>
        <td>Equipo interno</td>
    </tr>
    <tr>
        <td><strong>Penetration Testing</strong></td>
        <td>Semestral</td>
        <td>App m√≥vil, API Gateway, Web</td>
        <td>Proveedor externo certificado</td>
    </tr>
    <tr>
        <td><strong>Revisi√≥n de c√≥digo de seguridad</strong></td>
        <td>Por release mayor</td>
        <td>Cloud Functions, autenticaci√≥n</td>
        <td>Security Champion</td>
    </tr>
    <tr>
        <td><strong>Auditor√≠a de accesos</strong></td>
        <td>Trimestral</td>
        <td>Consola Firebase, GCP IAM</td>
        <td>L√≠der T√©cnico</td>
    </tr>
    <tr>
        <td><strong>Simulacro de incidente (Tabletop)</strong></td>
        <td>Semestral</td>
        <td>Escenarios S1 y S2</td>
        <td>CSIRT completo</td>
    </tr>
</table>

<h2>12.9.3. Escenarios de Breach Response</h2>
<table>
    <tr>
        <th>Escenario</th>
        <th>Clasificaci√≥n</th>
        <th>Acciones Inmediatas (&lt; 1 hora)</th>
        <th>Acciones de Seguimiento</th>
    </tr>
    <tr>
        <td><strong>Fuga de base de datos completa</strong></td>
        <td class="critico">S1 - Cr√≠tico</td>
        <td>1) Activar CSIRT<br>2) Revocar todos los tokens<br>3) Aislar servicios afectados<br>4) Notificar a Gerencia</td>
        <td>1) An√°lisis forense<br>2) Notificar a Autoridad de Protecci√≥n de Datos (&lt; 72h)<br>3) Comunicado a usuarios<br>4) Post-mortem</td>
    </tr>
    <tr>
        <td><strong>Compromiso de cuenta administrador</strong></td>
        <td class="critico">S1 - Cr√≠tico</td>
        <td>1) Desactivar cuenta<br>2) Rotar todos los secrets<br>3) Forzar cierre de sesiones admin</td>
        <td>1) Auditor√≠a de logs<br>2) Verificar integridad de datos<br>3) Revisar Security Rules</td>
    </tr>
    <tr>
        <td><strong>Ransomware en infraestructura</strong></td>
        <td class="critico">S1 - Cr√≠tico</td>
        <td>1) Aislar sistemas<br>2) Activar backup Firestore<br>3) NO pagar rescate</td>
        <td>1) Restaurar backup limpio<br>2) An√°lisis vector de entrada<br>3) Fortalecer controles</td>
    </tr>
    <tr>
        <td><strong>Defacement de landing page</strong></td>
        <td class="alto">S2 - Media</td>
        <td>1) Rollback a versi√≥n anterior<br>2) Verificar otros servicios</td>
        <td>1) An√°lisis de ataque<br>2) Revisar pipeline deploy</td>
    </tr>
    <tr>
        <td><strong>Scraping masivo de ofertas</strong></td>
        <td class="bajo">S3 - Baja</td>
        <td>1) Ban de IPs en WAF<br>2) Incrementar rate limiting</td>
        <td>1) Revisar pol√≠ticas<br>2) Considerar CAPTCHA</td>
    </tr>
    <tr>
        <td><strong>Fuga de credenciales API externa</strong></td>
        <td class="alto">S2 - Media</td>
        <td>1) Revocar credencial<br>2) Generar nueva<br>3) Actualizar Secret Manager</td>
        <td>1) Auditar uso<br>2) Verificar accesos no autorizados</td>
    </tr>
</table>

<h2>12.9.4. Comunicaci√≥n en Incidentes</h2>
<table>
    <tr>
        <th>Audiencia</th>
        <th>Canal</th>
        <th>Tiempo</th>
        <th>Responsable</th>
    </tr>
    <tr>
        <td>CSIRT interno</td>
        <td>Slack #incident-response + llamada</td>
        <td>Inmediato</td>
        <td>L√≠der de Incidente</td>
    </tr>
    <tr>
        <td>Gerencia CAIL</td>
        <td>Email + llamada telef√≥nica</td>
        <td>&lt; 1 hora</td>
        <td>L√≠der de Incidente</td>
    </tr>
    <tr>
        <td>Autoridad de Protecci√≥n de Datos</td>
        <td>Formulario oficial</td>
        <td>&lt; 72 horas (si aplica)</td>
        <td>Oficial Legal</td>
    </tr>
    <tr>
        <td>Usuarios afectados</td>
        <td>Email + notificaci√≥n in-app</td>
        <td>&lt; 7 d√≠as (si aplica)</td>
        <td>Comunicaciones + Legal</td>
    </tr>
    <tr>
        <td>P√∫blico general</td>
        <td>Comunicado en website</td>
        <td>Seg√∫n decisi√≥n de Gerencia</td>
        <td>Comunicaciones</td>
    </tr>
</table>

<!-- ============================================================ -->
<!-- ANEXO A: GLOSARIO -->
<!-- ============================================================ -->
<h1>ANEXO A: Glosario de T√©rminos T√©cnicos</h1>

<table>
    <tr>
        <th style="width: 25%;">T√©rmino</th>
        <th>Definici√≥n</th>
    </tr>
    <tr>
        <td><strong>API Gateway</strong></td>
        <td>Punto de entrada √∫nico que gestiona, asegura y monitorea las llamadas a los microservicios. En CAIL se utiliza WSO2 API Manager.</td>
    </tr>
    <tr>
        <td><strong>ARCO+</strong></td>
        <td>Derechos de Acceso, Rectificaci√≥n, Cancelaci√≥n (Eliminaci√≥n), Oposici√≥n y Portabilidad de datos personales, garantizados por la LOPDP.</td>
    </tr>
    <tr>
        <td><strong>ATS (App Transport Security)</strong></td>
        <td>Mecanismo de iOS que obliga a las apps a usar conexiones HTTPS seguras.</td>
    </tr>
    <tr>
        <td><strong>Certificate Pinning</strong></td>
        <td>T√©cnica que asocia un certificado espec√≠fico con un servidor, previniendo ataques man-in-the-middle.</td>
    </tr>
    <tr>
        <td><strong>CI/CD</strong></td>
        <td>Integraci√≥n Continua / Despliegue Continuo. Pr√°cticas DevOps para automatizar la construcci√≥n, prueba y despliegue de software.</td>
    </tr>
    <tr>
        <td><strong>Cloud Functions</strong></td>
        <td>Funciones serverless de Firebase/GCP que ejecutan c√≥digo backend sin gestionar servidores.</td>
    </tr>
    <tr>
        <td><strong>CSP (Content Security Policy)</strong></td>
        <td>Header HTTP que controla qu√© recursos puede cargar una p√°gina web, previniendo XSS.</td>
    </tr>
    <tr>
        <td><strong>CSIRT</strong></td>
        <td>Computer Security Incident Response Team. Equipo de respuesta a incidentes de seguridad.</td>
    </tr>
    <tr>
        <td><strong>DevSecOps</strong></td>
        <td>Cultura que integra pr√°cticas de seguridad en todo el ciclo de desarrollo de software.</td>
    </tr>
    <tr>
        <td><strong>DOMPurify</strong></td>
        <td>Librer√≠a JavaScript para sanitizar HTML y prevenir ataques XSS.</td>
    </tr>
    <tr>
        <td><strong>Firestore</strong></td>
        <td>Base de datos NoSQL en tiempo real de Firebase/Google Cloud, utilizada como persistencia principal en CAIL.</td>
    </tr>
    <tr>
        <td><strong>JWT (JSON Web Token)</strong></td>
        <td>Est√°ndar (RFC 7519) para tokens de autenticaci√≥n seguros y autocontenidos.</td>
    </tr>
    <tr>
        <td><strong>Keychain (iOS)</strong></td>
        <td>Sistema seguro de almacenamiento de credenciales en dispositivos Apple.</td>
    </tr>
    <tr>
        <td><strong>Keystore (Android)</strong></td>
        <td>Sistema de almacenamiento criptogr√°fico seguro en dispositivos Android.</td>
    </tr>
    <tr>
        <td><strong>LOPDP</strong></td>
        <td>Ley Org√°nica de Protecci√≥n de Datos Personales de Ecuador (2021).</td>
    </tr>
    <tr>
        <td><strong>MFA</strong></td>
        <td>Multi-Factor Authentication. Autenticaci√≥n que requiere m√∫ltiples factores de verificaci√≥n.</td>
    </tr>
    <tr>
        <td><strong>MTTR</strong></td>
        <td>Mean Time To Recovery/Repair. Tiempo promedio de recuperaci√≥n ante incidentes.</td>
    </tr>
    <tr>
        <td><strong>OWASP</strong></td>
        <td>Open Web Application Security Project. Organizaci√≥n que publica est√°ndares y gu√≠as de seguridad.</td>
    </tr>
    <tr>
        <td><strong>ProGuard/R8</strong></td>
        <td>Herramientas de ofuscaci√≥n y optimizaci√≥n de c√≥digo para aplicaciones Android.</td>
    </tr>
    <tr>
        <td><strong>Rate Limiting</strong></td>
        <td>T√©cnica para limitar la cantidad de requests que un cliente puede hacer en un per√≠odo de tiempo.</td>
    </tr>
    <tr>
        <td><strong>RBAC</strong></td>
        <td>Role-Based Access Control. Control de acceso basado en roles asignados a usuarios.</td>
    </tr>
    <tr>
        <td><strong>SAST</strong></td>
        <td>Static Application Security Testing. An√°lisis de seguridad del c√≥digo fuente sin ejecutarlo.</td>
    </tr>
    <tr>
        <td><strong>Security Champion</strong></td>
        <td>Miembro del equipo de desarrollo con responsabilidades adicionales de seguridad.</td>
    </tr>
    <tr>
        <td><strong>SLO</strong></td>
        <td>Service Level Objective. Objetivo medible de nivel de servicio.</td>
    </tr>
    <tr>
        <td><strong>SQLCipher</strong></td>
        <td>Extensi√≥n de SQLite que proporciona cifrado transparente de base de datos.</td>
    </tr>
    <tr>
        <td><strong>TLS (Transport Layer Security)</strong></td>
        <td>Protocolo criptogr√°fico para comunicaciones seguras sobre redes. CAIL usa TLS 1.3.</td>
    </tr>
    <tr>
        <td><strong>WAF</strong></td>
        <td>Web Application Firewall. Firewall especializado que filtra tr√°fico HTTP malicioso.</td>
    </tr>
    <tr>
        <td><strong>WSO2</strong></td>
        <td>Plataforma de integraci√≥n y gesti√≥n de APIs utilizada como gateway en CAIL.</td>
    </tr>
    <tr>
        <td><strong>Zod</strong></td>
        <td>Librer√≠a TypeScript para validaci√≥n de esquemas de datos.</td>
    </tr>
</table>

<!-- ============================================================ -->
<!-- RESUMEN DE CAMBIOS -->
<!-- ============================================================ -->
<h1>Resumen de Cambios Realizados</h1>

<table>
    <tr>
        <th>Secci√≥n</th>
        <th>Tipo de Cambio</th>
        <th>Descripci√≥n</th>
    </tr>
    <tr>
        <td>12.2</td>
        <td><strong>Mejorado</strong></td>
        <td>Tabla de controles espec√≠ficos web, ejemplo de c√≥digo sanitizaci√≥n</td>
    </tr>
    <tr>
        <td>12.3</td>
        <td><strong>Mejorado</strong></td>
        <td>Tabla diferenciada Android/iOS, ejemplos de c√≥digo React Native</td>
    </tr>
    <tr>
        <td>12.6</td>
        <td><strong>Nueva</strong></td>
        <td>Matrices OWASP Top 10 y Mobile Top 10, ejemplo de validaci√≥n con Zod, diagrama de secuencia de autenticaci√≥n</td>
    </tr>
    <tr>
        <td>12.7</td>
        <td><strong>Nueva</strong></td>
        <td>KPIs de seguridad, herramientas de monitoreo, alertas automatizadas</td>
    </tr>
    <tr>
        <td>12.8</td>
        <td><strong>Nueva</strong></td>
        <td>Referencias cruzadas con otras secciones del SAD</td>
    </tr>
    <tr>
        <td>12.9</td>
        <td><strong>Nueva</strong></td>
        <td>Roadmap ISO 27001, plan de auditor√≠a, escenarios de breach response</td>
    </tr>
    <tr>
        <td>Anexo A</td>
        <td><strong>Nueva</strong></td>
        <td>Glosario de 30+ t√©rminos t√©cnicos</td>
    </tr>
</table>

<!-- PIE DE P√ÅGINA -->
<div class="footer">
    <p><strong>Documento de Arquitectura de Software - Bolsa de Empleo CAIL</strong></p>
    <p>Secci√≥n 12: Seguridad (Versi√≥n Ampliada) | Versi√≥n 1.1 | Diciembre 2025</p>
    <p><em>Preparado para integraci√≥n en SAD-CAIL principal</em></p>
</div>

</body>
</html>

